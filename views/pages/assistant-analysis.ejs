<!DOCTYPE html>
<html lang="de" data-theme="helpbaerai" class="h-full">
<head>
    <%- include('../partials/head') %>
    <title>HelpBärAI - <%= assistant.title %></title>
    <script src="/js/assistant-analysis.js" defer></script>
</head>
<body class="bg-base-100 text-base-content flex flex-col min-h-screen">
    <%- include('../partials/header') %>

    <div class="flex-grow flex">
        <main class="flex-grow p-4 lg:p-8 flex justify-center">
            <div class="w-full max-w-4xl"> <!-- Added container with max-width -->
                <h1 class="text-3xl font-bold mb-4 text-center"><%= assistant.title %></h1>
                <p class="mb-6 text-center"><%= assistant.description %></p>
                
                <div class="mb-6">
                    <div class="tabs tabs-boxed mb-4">
                        <a class="tab tab-active" id="textTab">Text eingeben</a>
                        <a class="tab" id="urlTab">URL eingeben</a>
                    </div>
                    
                    <div id="textInput" class="relative">
                        <textarea class="textarea textarea-bordered w-full h-48 p-4 pr-16" placeholder="Geben Sie hier Ihren Text ein..." id="analysisTextarea" maxlength="2000"></textarea>
                        <div class="absolute top-2 right-2 flex space-x-2">
                            <button class="btn btn-ghost btn-sm p-1" id="paste-clipboard">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                                </svg>
                            </button>
                            <button class="btn btn-ghost btn-sm p-1 hidden" id="clear-textarea">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                        <div class="absolute bottom-2 right-2 text-sm text-gray-500" id="charCounter">0 / 2000</div>
                    </div>
                    
                    <div id="urlInput" class="hidden relative">
                        <input type="url" placeholder="https://www.beispiel.de" class="input input-bordered w-full pr-16" id="urlInputField" />
                        <div class="absolute top-1/2 right-2 transform -translate-y-1/2 flex space-x-2">
                            <button class="btn btn-ghost btn-sm p-1" id="paste-url">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                                </svg>
                            </button>
                            <button class="btn btn-ghost btn-sm p-1 hidden" id="clear-url">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="relative mb-6">
                    <input type="text" placeholder="Weitere Anforderungen oder Hinweise" class="input input-bordered w-full pr-16" id="additionalRequirements" maxlength="100" />
                    <div class="absolute bottom-2 right-2 text-sm text-gray-500" id="additionalCharCounter">0 / 100</div>
                </div>
                
                <div class="flex flex-wrap gap-2 mb-6">
                    <% assistant.operations.forEach(operation => { %>
                        <button class="btn btn-primary flex-1"><%= operation.name %></button>
                    <% }); %>
                </div>
            </div>
        </main>
        
        <aside class="w-12 bg-base-200 transition-all duration-300 ease-in-out overflow-hidden sm:w-full md:w-1/2 lg:max-w-1/2" id="sidepanel">
            <div class="flex flex-col h-full">
                <button class="btn bg-info self-end p-2" id="toggleSidepanel" title="Hilfe anzeigen/ausblenden">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0-2.25h.008v.008H12v-.008z" />
                    </svg>
                </button>
                <div class="flex-grow overflow-y-auto p-4 hidden" id="sidepanel-content">
                    <img src="<%= assistant.image %>" alt="<%= assistant.alt %>" class="w-24 h-24 rounded-full mx-auto mb-4">
                    <p class="text-sm mb-4 text-center"><%= assistant.description %></p>
                    <div class="join join-vertical w-full">
                        <% assistant.operations.forEach((operation, index) => { %>
                            <div class="collapse collapse-arrow join-item border border-base-300">
                                <input type="radio" name="my-accordion-4" <%= index === 0 ? 'checked="checked"' : '' %> /> 
                                <div class="collapse-title text-xl font-medium">
                                    <%= operation.name %>
                                </div>
                                <div class="collapse-content"> 
                                    <p><%= operation.description %></p>
                                    <button class="btn btn-primary btn-sm mt-2 load-sample-text" data-filename="<%= operation.sampleTextFile.split('/').pop() %>">
                                        Mustertext einfügen
                                    </button>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <%- include('../partials/footer') %>
</body>
</html>